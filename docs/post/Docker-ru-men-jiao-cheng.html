<!DOCTYPE html>
<html data-color-mode="light" data-dark-theme="dark" data-light-theme="light" lang="zh-CN">
<head>
    <meta content="text/html; charset=utf-8" http-equiv="content-type" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link href='https://mirrors.sustech.edu.cn/cdnjs/ajax/libs/Primer/21.0.7/primer.css' rel='stylesheet' />
    
    <link rel="icon" href="https://github.githubassets.com/favicons/favicon.svg"><script>
        let theme = localStorage.getItem("meek_theme") || "light";
        document.documentElement.setAttribute("data-color-mode", theme);
    </script>
<meta name="description" content="[Docker](https://www.docker.com/) 是一个开源的应用容器引擎，而一个容器containers其实是一个虚拟化的独立的环境，让开发者可以打包他们的应用以及依赖包到一个可移植的容器中，然后发布到任何流行的 Linux 机器上，也可以实现虚拟化。">
<meta property="og:title" content="Docker入门教程">
<meta property="og:description" content="[Docker](https://www.docker.com/) 是一个开源的应用容器引擎，而一个容器containers其实是一个虚拟化的独立的环境，让开发者可以打包他们的应用以及依赖包到一个可移植的容器中，然后发布到任何流行的 Linux 机器上，也可以实现虚拟化。">
<meta property="og:type" content="article">
<meta property="og:url" content="https://HubertHu137.github.io/Blog/post/Docker-ru-men-jiao-cheng.html">
<meta property="og:image" content="https://github.githubassets.com/favicons/favicon.svg">
<title>Docker入门教程</title>
<link href="//unpkg.com/@wooorm/starry-night@2.1.1/style/both.css" rel="stylesheet" />


</head>
<style>
body{box-sizing: border-box;min-width: 200px;max-width: 900px;margin: 20px auto;padding: 45px;font-size: 16px;font-family: sans-serif;line-height: 1.25;}
#header{display:flex;padding-bottom:8px;border-bottom: 1px solid var(--borderColor-muted, var(--color-border-muted));margin-bottom: 16px;}
#footer {margin-top:64px; text-align: center;font-size: small;}

</style>

<style>
.postTitle{margin: auto 0;font-size:40px;font-weight:bold;}
.title-right{display:flex;margin:auto 0 0 auto;}
.title-right .circle{padding: 14px 16px;margin-right:8px;}
#postBody{border-bottom: 1px solid var(--color-border-default);padding-bottom:36px;}
#postBody hr{height:2px;}
#cmButton{height:48px;margin-top:48px;}
#comments{margin-top:64px;}
.g-emoji{font-size:24px;}
@media (max-width: 600px) {
    body {padding: 8px;}
    .postTitle{font-size:24px;}
}
.copy-feedback {
    display: none;
    position: absolute;
    top: 10px;
    right: 50px;
    color: var(--color-fg-on-emphasis);
    background-color: var(--color-fg-muted);
    border-radius: 3px;
    padding: 5px 8px;
    font-size: 12px;
}
</style>




<body>
    <div id="header">
<h1 class="postTitle">Docker入门教程</h1>
<div class="title-right">
    <a href="https://HubertHu137.github.io/Blog" id="buttonHome" class="btn btn-invisible circle" title="首页">
        <svg class="octicon" width="16" height="16">
            <path id="pathHome" fill-rule="evenodd"></path>
        </svg>
    </a>
    
    <a href="https://github.com/HubertHu137/Blog/issues/2" target="_blank" class="btn btn-invisible circle" title="Issue">
        <svg class="octicon" width="16" height="16">
            <path id="pathIssue" fill-rule="evenodd"></path>
        </svg>
    </a>
    

    <a class="btn btn-invisible circle" onclick="modeSwitch();" title="切换主题">
        <svg class="octicon" width="16" height="16" >
            <path id="themeSwitch" fill-rule="evenodd"></path>
        </svg>
    </a>

</div>
</div>
    <div id="content">
<div class="markdown-body" id="postBody"><p><a href="https://www.docker.com/" rel="nofollow">Docker</a> 是一个开源的应用容器引擎，而一个容器containers其实是一个虚拟化的独立的环境，让开发者可以打包他们的应用以及依赖包到一个可移植的容器中，然后发布到任何流行的 Linux 机器上，也可以实现虚拟化。容器是完全使用沙箱机制，相互之间不会有任何接口。</p>
<blockquote>
<p>Docker 的局限性之一，它只能用在 64 位的操作系统上。</p>
</blockquote>
<h1>目录</h1>
<p><a href="https://github.com/jaywcjlove/docker-tutorial#%E7%9B%AE%E5%BD%95"></a></p>
<ul>
<li><a href="https://github.com/jaywcjlove/docker-tutorial#%E6%96%B0%E7%89%88%E6%9C%AC%E5%AE%89%E8%A3%85">新版本安装</a></li>
<li><a href="https://github.com/jaywcjlove/docker-tutorial#%E6%97%A7%E7%89%88%E6%9C%AC%E5%AE%89%E8%A3%85">旧版本安装</a></li>
<li><a href="https://github.com/jaywcjlove/docker-tutorial#%E5%91%BD%E4%BB%A4%E4%BB%8B%E7%BB%8D">命令介绍</a></li>
<li><a href="https://github.com/jaywcjlove/docker-tutorial#%E6%9C%8D%E5%8A%A1%E7%AE%A1%E7%90%86">服务管理</a></li>
<li><a href="https://github.com/jaywcjlove/docker-tutorial#%E9%95%9C%E5%83%8F%E7%AE%A1%E7%90%86">镜像管理</a>
<ul>
<li><a href="https://github.com/jaywcjlove/docker-tutorial#%E9%80%9A%E8%BF%87%E5%AE%B9%E5%99%A8%E5%88%9B%E5%BB%BA%E9%95%9C%E5%83%8F">通过容器创建镜像</a></li>
<li><a href="https://github.com/jaywcjlove/docker-tutorial#%E9%80%9A%E8%BF%87dockerfile%E5%88%9B%E5%BB%BA%E9%95%9C%E5%83%8F">通过Dockerfile创建镜像</a></li>
<li><a href="https://github.com/jaywcjlove/docker-tutorial#%E5%8F%91%E5%B8%83%E8%87%AA%E5%B7%B1%E7%9A%84%E9%95%9C%E5%83%8F">发布自己的镜像</a></li>
<li><a href="https://github.com/jaywcjlove/docker-tutorial#%E9%95%9C%E5%83%8F%E4%B8%AD%E5%AE%89%E8%A3%85%E8%BD%AF%E4%BB%B6">镜像中安装软件</a></li>
</ul>
</li>
<li><a href="https://github.com/jaywcjlove/docker-tutorial#%E5%AE%B9%E5%99%A8%E7%AE%A1%E7%90%86">容器管理</a>
<ul>
<li><a href="https://github.com/jaywcjlove/docker-tutorial#%E5%AE%B9%E5%99%A8%E6%9C%8D%E5%8A%A1%E7%AE%A1%E7%90%86">容器服务管理</a></li>
<li><a href="https://github.com/jaywcjlove/docker-tutorial#%E8%BF%9B%E5%85%A5%E5%AE%B9%E5%99%A8">进入容器</a></li>
</ul>
</li>
<li><a href="https://github.com/jaywcjlove/docker-tutorial#%E6%96%87%E4%BB%B6%E6%8B%B7%E8%B4%9D">文件拷贝</a></li>
<li><a href="https://github.com/jaywcjlove/docker-tutorial#docker%E7%A7%81%E6%9C%89%E4%BB%93%E5%BA%93%E6%90%AD%E5%BB%BA">Docker私有仓库搭建</a>
<ul>
<li><a href="https://github.com/jaywcjlove/docker-tutorial#registry"><code class="notranslate">registry</code></a></li>
<li><a href="https://github.com/jaywcjlove/docker-tutorial#harbor"><code class="notranslate">Harbor</code></a></li>
</ul>
</li>
<li><a href="https://github.com/jaywcjlove/docker-tutorial#%E4%BD%BF%E7%94%A8-docker-%E5%AE%9E%E6%88%98">使用 Docker 实战</a></li>
<li><a href="https://github.com/jaywcjlove/docker-tutorial#docker-rest-api">Docker REST API</a>
<ul>
<li><a href="https://github.com/jaywcjlove/docker-tutorial#nginx"><code class="notranslate">Nginx</code></a></li>
<li><a href="https://github.com/jaywcjlove/docker-tutorial#mysql"><code class="notranslate">MySQL</code></a></li>
<li><a href="https://github.com/jaywcjlove/docker-tutorial#postgres"><code class="notranslate">PostgreSQL</code></a></li>
<li><a href="https://github.com/jaywcjlove/docker-tutorial#redis"><code class="notranslate">Redis</code></a></li>
<li><a href="https://github.com/jaywcjlove/docker-tutorial#elasticsearch"><code class="notranslate">Elasticsearch</code></a></li>
<li><a href="https://github.com/jaywcjlove/docker-tutorial#gitlab"><code class="notranslate">Gitlab</code></a></li>
<li><a href="https://github.com/jaywcjlove/docker-tutorial#jenkins"><code class="notranslate">Jenkins</code></a></li>
<li><a href="https://github.com/jaywcjlove/docker-tutorial#rocketchat"><code class="notranslate">Rocket.Chat</code></a></li>
<li><a href="https://github.com/jaywcjlove/docker-tutorial#rancher"><code class="notranslate">Rancher</code></a></li>
<li><a href="https://github.com/jaywcjlove/docker-tutorial#portainer"><code class="notranslate">Portainer</code></a></li>
<li><a href="https://github.com/jaywcjlove/docker-tutorial#sourcegraph"><code class="notranslate">Sourcegraph</code></a></li>
<li><a href="https://github.com/jaywcjlove/docker-tutorial#Mattermost"><code class="notranslate">Mattermost</code></a></li>
<li><a href="https://github.com/jaywcjlove/docker-tutorial#nps"><code class="notranslate">NPS</code></a></li>
<li><a href="https://github.com/jaywcjlove/docker-tutorial#penpot"><code class="notranslate">Penpot</code></a></li>
<li><a href="https://github.com/jaywcjlove/docker-tutorial#navidrome"><code class="notranslate">Navidrome</code></a></li>
<li><a href="https://github.com/jaywcjlove/docker-tutorial#humpback"><code class="notranslate">Humpback</code></a></li>
<li><a href="https://github.com/jaywcjlove/docker-tutorial#seafile"><code class="notranslate">Seafile</code></a></li>
<li><a href="https://github.com/jaywcjlove/docker-tutorial#%E6%9B%B4%E5%A4%9A">更多</a></li>
</ul>
</li>
<li><a href="https://github.com/jaywcjlove/docker-tutorial#%E5%8D%B8%E8%BD%BD%E6%97%A7%E7%9A%84%E7%89%88%E6%9C%AC">卸载旧的版本</a></li>
<li><a href="https://github.com/jaywcjlove/docker-tutorial#%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86">错误处理</a></li>
<li><a href="https://github.com/jaywcjlove/docker-tutorial#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99">参考资料</a>
<ul>
<li><a href="https://github.com/jaywcjlove/docker-tutorial#%E5%AE%98%E6%96%B9%E8%8B%B1%E6%96%87%E8%B5%84%E6%BA%90">官方英文资源</a></li>
<li><a href="https://github.com/jaywcjlove/docker-tutorial#%E4%B8%AD%E6%96%87%E8%B5%84%E6%BA%90">中文资源</a></li>
<li><a href="https://github.com/jaywcjlove/docker-tutorial#%E5%85%B6%E5%AE%83%E8%B5%84%E6%BA%90">其它资源</a></li>
</ul>
</li>
</ul>
<p>Docker 从 <code class="notranslate">1.13</code> 版本之后采用时间线的方式作为版本号，分为社区版 <code class="notranslate">CE</code> 和企业版 <code class="notranslate">EE</code>，社区版是免费提供给个人开发者和小型团体使用的，企业版会提供额外的收费服务，比如经过官方测试认证过的基础设施、容器、插件等。</p>
<p>社区版按照 <code class="notranslate">stable</code> 和 <code class="notranslate">edge</code> 两种方式发布，每个季度更新 <code class="notranslate">stable</code> 版本，如 <code class="notranslate">17.06</code>，<code class="notranslate">17.09</code>；每个月份更新 <code class="notranslate">edge</code> 版本，如<code class="notranslate">17.09</code>，<code class="notranslate">17.10</code>。</p>
<p>下面教程运行在 <code class="notranslate">Centos</code> 中</p>
<h2>新版本安装</h2>
<p><a href="https://github.com/jaywcjlove/docker-tutorial#%E6%96%B0%E7%89%88%E6%9C%AC%E5%AE%89%E8%A3%85"></a></p>
<p>Docker 官方的安装教程，<a href="https://docs.docker.com/install/linux/docker-ce/centos/" rel="nofollow">在这里</a>。</p>
<p>安装一些必要的系统工具</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">sudo yum install -y yum-utils device-mapper-persistent-data lvm2</pre></div>
<p>添加软件源信息</p>
<div class="highlight highlight-source-shell"><pre class="notranslate"><span class="pl-c"><span class="pl-c">#</span> docker 官方源</span>
sudo yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo
<span class="pl-c"><span class="pl-c">#</span> 阿里云源</span>
sudo yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</pre></div>
<p>可选：启用 <code class="notranslate">edge</code> 和 <code class="notranslate">test</code> 存储库。 这些存储库包含在上面的 <code class="notranslate">docker.repo</code> 文件中，但默认情况下处于禁用状态。您可以将它们与稳定存储库一起启用。</p>
<pre class="notranslate"><code class="notranslate">$ sudo yum-config-manager --enable docker-ce-edge
$ sudo yum-config-manager --enable docker-ce-test
</code></pre>
<p>您可以通过使用 <code class="notranslate">--disable</code> 标志运行 <code class="notranslate">yum-config-manager</code> 命令来禁用边缘或测试存储库。 要重新启用它，请使用 <code class="notranslate">--enable</code> 标志。 以下命令禁用 <code class="notranslate">edge</code> 存储库:</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">$ sudo yum-config-manager --disable docker-ce-edge
$ sudo yum-config-manager --disable docker-ce-test</pre></div>
<p>安装 Docker-ce</p>
<div class="highlight highlight-source-shell"><pre class="notranslate"><span class="pl-c"><span class="pl-c">#</span> 安装前可以先更新 yum 缓存：</span>
sudo yum makecache fast
<span class="pl-c"><span class="pl-c">#</span> 安装 Docker-ce</span>
sudo yum install docker-ce</pre></div>
<p>如果你想安装特定 <code class="notranslate">docker-ce</code> 版本，先列出 repo 中可用版本，然后选择安装</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">$ yum list docker-ce --showduplicates <span class="pl-k">|</span> sort -r
<span class="pl-c"><span class="pl-c">#</span> docker-ce.x86_64       18.06.1.ce-3.el7              docker-ce-stable</span>
<span class="pl-c"><span class="pl-c">#</span> docker-ce.x86_64       18.06.1.ce-3.el7              @docker-ce-stable</span>
<span class="pl-c"><span class="pl-c">#</span> docker-ce.x86_64       18.06.0.ce-3.el7              docker-ce-stable</span>
<span class="pl-c"><span class="pl-c">#</span> docker-ce.x86_64       18.03.1.ce-1.el7.centos       docker-ce-stable</span>
<span class="pl-c"><span class="pl-c">#</span> docker-ce.x86_64       18.03.0.ce-1.el7.centos       docker-ce-stable</span>
<span class="pl-c"><span class="pl-c">#</span> docker-ce.x86_64       17.12.1.ce-1.el7.centos       docker-ce-stable</span>
<span class="pl-c"><span class="pl-c">#</span> 选择版本安装</span>
$ sudo yum install docker-ce-<span class="pl-k">&lt;</span>VERSION STRING<span class="pl-k">&gt;</span>

<span class="pl-c"><span class="pl-c">#</span> 选择安装 docker-ce-18.06.1.ce</span>
$ sudo yum install docker-ce-18.06.1.ce</pre></div>
<p>启动 Docker 后台服务</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">$ sudo systemctl start docker</pre></div>
<p>通过运行 <code class="notranslate">hello-world</code> 镜像，验证是否正确安装了 <code class="notranslate">docker</code>。</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">$ docker run hello-world</pre></div>
<h2>旧版本安装</h2>
<p><a href="https://github.com/jaywcjlove/docker-tutorial#%E6%97%A7%E7%89%88%E6%9C%AC%E5%AE%89%E8%A3%85"></a></p>
<div class="highlight highlight-source-shell"><pre class="notranslate">yum install docker        <span class="pl-c"><span class="pl-c">#</span> CentOS 中安装</span>
apt-get install docker-ce <span class="pl-c"><span class="pl-c">#</span> Ubuntu 中安装</span>
pacman -S docker          <span class="pl-c"><span class="pl-c">#</span> Arch 中安装</span>
emerge --ask docker       <span class="pl-c"><span class="pl-c">#</span> Gentoo 中安装</span>

<span class="pl-c"><span class="pl-c">#</span>=====================</span>
docker version      <span class="pl-c"><span class="pl-c">#</span> 通过查看版本，检查安装是否成功</span>
<span class="pl-c"><span class="pl-c">#</span> Client:</span>
<span class="pl-c"><span class="pl-c">#</span>  Version:         1.12.6</span>
<span class="pl-c"><span class="pl-c">#</span>  API version:     1.24</span>
<span class="pl-c"><span class="pl-c">#</span>  Package version: docker-1.12.6-55.gitc4618fb.el7.centos.x86_64</span>
<span class="pl-c"><span class="pl-c">#</span>  Go version:      go1.8.3</span>
<span class="pl-c"><span class="pl-c">#</span>  Git commit:      c4618fb/1.12.6</span>
<span class="pl-c"><span class="pl-c">#</span>  Built:           Thu Sep 21 22:33:52 2017</span>
<span class="pl-c"><span class="pl-c">#</span>  OS/Arch:         linux/amd64</span>
<span class="pl-c"><span class="pl-c">#</span> </span>
<span class="pl-c"><span class="pl-c">#</span> Server:</span>
<span class="pl-c"><span class="pl-c">#</span>  Version:         1.12.6</span>
<span class="pl-c"><span class="pl-c">#</span>  API version:     1.24</span>
<span class="pl-c"><span class="pl-c">#</span>  Package version: docker-1.12.6-55.gitc4618fb.el7.centos.x86_64</span>
<span class="pl-c"><span class="pl-c">#</span>  Go version:      go1.8.3</span>
<span class="pl-c"><span class="pl-c">#</span>  Git commit:      c4618fb/1.12.6</span>
<span class="pl-c"><span class="pl-c">#</span>  Built:           Thu Sep 21 22:33:52 2017</span>
<span class="pl-c"><span class="pl-c">#</span>  OS/Arch:         linux/amd64</span></pre></div>
<h2>命令介绍</h2>
<p><a href="https://github.com/jaywcjlove/docker-tutorial#%E5%91%BD%E4%BB%A4%E4%BB%8B%E7%BB%8D"></a></p>
<div class="highlight highlight-source-shell"><pre class="notranslate">$ docker --help

管理命令:
  container   管理容器
  image       管理镜像
  network     管理网络
命令：
  attach      介入到一个正在运行的容器
  build       根据 Dockerfile 构建一个镜像
  commit      根据容器的更改创建一个新的镜像
  cp          在本地文件系统与容器中复制 文件/文件夹
  create      创建一个新容器
  <span class="pl-c1">exec</span>        在容器中执行一条命令
  images      列出镜像
  <span class="pl-c1">kill</span>        杀死一个或多个正在运行的容器    
  logs        取得容器的日志
  pause       暂停一个或多个容器的所有进程
  ps          列出所有容器
  pull        拉取一个镜像或仓库到 registry
  push        推送一个镜像或仓库到 registry
  rename      重命名一个容器
  restart     重新启动一个或多个容器
  rm          删除一个或多个容器
  rmi         删除一个或多个镜像
  run         在一个新的容器中执行一条命令
  search      在 Docker Hub 中搜索镜像
  start       启动一个或多个已经停止运行的容器
  stats       显示一个容器的实时资源占用
  stop        停止一个或多个正在运行的容器
  tag         为镜像创建一个新的标签
  top         显示一个容器内的所有进程
  unpause     恢复一个或多个容器内所有被暂停的进程</pre></div>
<h2>服务管理</h2>
<p><a href="https://github.com/jaywcjlove/docker-tutorial#%E6%9C%8D%E5%8A%A1%E7%AE%A1%E7%90%86"></a></p>
<div class="highlight highlight-source-shell"><pre class="notranslate">service docker start       <span class="pl-c"><span class="pl-c">#</span> 启动 docker 服务，守护进程</span>
service docker stop        <span class="pl-c"><span class="pl-c">#</span> 停止 docker 服务</span>
service docker status      <span class="pl-c"><span class="pl-c">#</span> 查看 docker 服务状态</span>
chkconfig docker on        <span class="pl-c"><span class="pl-c">#</span> 设置为开机启动</span></pre></div>
<h2>镜像管理</h2>
<p><a href="https://github.com/jaywcjlove/docker-tutorial#%E9%95%9C%E5%83%8F%E7%AE%A1%E7%90%86"></a></p>
<p>镜像可以看做我们平时装系统的镜像，里面就是一个运行环境。</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">docker pull centos:latest  <span class="pl-c"><span class="pl-c">#</span> 从docker.io中下载centos镜像到本地</span>
docker images              <span class="pl-c"><span class="pl-c">#</span> 查看已下载的镜像</span>
docker rmi [image_id]      <span class="pl-c"><span class="pl-c">#</span> 删除镜像，指定镜像id</span>

<span class="pl-c"><span class="pl-c">#</span> 删除所有镜像</span>
<span class="pl-c"><span class="pl-c">#</span> none 默认为 docker.io</span>
docker rmi <span class="pl-s"><span class="pl-pds">$(</span>docker images <span class="pl-k">|</span> grep none <span class="pl-k">|</span> awk <span class="pl-s"><span class="pl-pds">'</span>{print $3}<span class="pl-pds">'</span></span> <span class="pl-k">|</span> sort -r<span class="pl-pds">)</span></span>

<span class="pl-c"><span class="pl-c">#</span> 连接进行进入命令行模式，exit命令退出。</span>
docker run -t -i nginx:latest /bin/bash</pre></div>
<h3>下载镜像本地安装镜像</h3>
<p><a href="https://github.com/jaywcjlove/docker-tutorial#%E4%B8%8B%E8%BD%BD%E9%95%9C%E5%83%8F%E6%9C%AC%E5%9C%B0%E5%AE%89%E8%A3%85%E9%95%9C%E5%83%8F"></a></p>
<p>由于国区已经无法访问，可以将镜像打包，直接安装镜像压缩文件</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">$ docker pull gitlab/gitlab-ce:17.2.0-ce.0 <span class="pl-c"><span class="pl-c">#</span> 下载镜像</span>
$ docker pull --platform linux/amd64 gitlab/gitlab-ce:17.2.0-ce.0
$ docker pull --platform linux/amd64 portainer/portainer-ce:2.20.3-alpine
$ docker pull --platform linux/amd64 portainer/agent:2.20.3-alpine
<span class="pl-c"><span class="pl-c">#</span> 保存 Docker 镜像到本地文件</span>
$ docker save -o [output-file.tar] [image-name]
$ docker save -o gitlab-ce.0-17.2.0.tar gitlab/gitlab-ce:17.2.0-ce.0
$ docker save -o portainer-agent-2.20.3-alpine.tar portainer/agent:2.20.3-alpine
$ docker save -o portainer-ce-2.20.3-alpine.tar portainer/portainer-ce:2.20.3-alpine</pre></div>
<p>将镜像文件发送到服务器</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">$ scp [output-file.tar] [user]@[server-ip]:[path]
$ scp gitlab-ce-17.0.1.tar root@110.55.8.163:/home/docker-images</pre></div>
<p>服务器上加载 Docker 镜像</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">$ docker load -i /home/docker-images/gitlab-ce-17.0.1.tar <span class="pl-c"><span class="pl-c">#</span> 加载 Docker 镜像</span>
$ docker images <span class="pl-c"><span class="pl-c">#</span> 验证镜像是否加载成功</span></pre></div>
<h3>通过容器创建镜像</h3>
<p><a href="https://github.com/jaywcjlove/docker-tutorial#%E9%80%9A%E8%BF%87%E5%AE%B9%E5%99%A8%E5%88%9B%E5%BB%BA%E9%95%9C%E5%83%8F"></a></p>
<p>我们可以通过以下两种方式对镜像进行更改。</p>
<ol>
<li>从已经创建的容器中更新镜像，并且提交这个镜像</li>
<li>使用 Dockerfile 指令来创建一个新的镜像</li>
</ol>
<p>下面通过已存在的容器创建一个新的镜像。</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">docker commit -m=<span class="pl-s"><span class="pl-pds">"</span>First Docker<span class="pl-pds">"</span></span> -a=<span class="pl-s"><span class="pl-pds">"</span>wcjiang<span class="pl-pds">"</span></span> a6b0a6cfdacf wcjiang/nginx:v1.2.1</pre></div>
<p>上面命令参数说明：</p>
<ul>
<li><code class="notranslate">-m</code> 提交的描述信息</li>
<li><code class="notranslate">-a</code> 指定镜像作者</li>
<li><code class="notranslate">a6b0a6cfdacf</code> 记住这个是容器id，不是镜像id</li>
<li><code class="notranslate">wcjiang/nginx:v1.2.1</code> 创建的目标镜像名</li>
</ul>
<h3>通过Dockerfile创建镜像</h3>
<p><a href="https://github.com/jaywcjlove/docker-tutorial#%E9%80%9A%E8%BF%87dockerfile%E5%88%9B%E5%BB%BA%E9%95%9C%E5%83%8F"></a></p>
<p>假设创建一个 node.js 镜像，首先在 node.js 项目根目录创建文件。</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">touch Dockerfile .dockerignore</pre></div>
<p><code class="notranslate">.dockerignore</code> 文件内容，下面代码表示，这三个路径要排除，不要打包进入 image 文件。如果你没有路径要排除，这个文件可以不新建。</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">.git
node_modules
npm-debug.log</pre></div>
<p>Dockerfile 文件内容</p>
<div class="highlight highlight-source-dockerfile"><pre class="notranslate"><span class="pl-k">FROM</span> node:8.4
<span class="pl-k">COPY</span> . /app
<span class="pl-k">WORKDIR</span> /app
<span class="pl-k">RUN</span> npm install --registry=https://registry.npm.taobao.org
<span class="pl-k">EXPOSE</span> 3000</pre></div>
<ul>
<li><code class="notranslate">FROM node:8.4</code>：该 <code class="notranslate">image</code> 文件继承官方的 <code class="notranslate">node image</code>，冒号表示标签，这里标签是<code class="notranslate">8.4</code>，即<code class="notranslate">8.4</code>版本的 <code class="notranslate">node</code>。</li>
<li><code class="notranslate">COPY . /app</code>：将当前目录下的所有文件（除了 <code class="notranslate">.dockerignore</code> 排除的路径），都拷贝进入 <code class="notranslate">image</code> 文件的 <code class="notranslate">/app</code> 目录。</li>
<li><code class="notranslate">WORKDIR /app</code>：指定接下来的工作路径为<code class="notranslate">/app</code>。</li>
<li><code class="notranslate">RUN npm install</code>：在/app目录下，运行 <code class="notranslate">npm install</code> 命令安装依赖。注意，安装后所有的依赖，都将打包进入 <code class="notranslate">image</code> 文件。</li>
<li><code class="notranslate">EXPOSE 3000</code>：将容器 <code class="notranslate">3000</code> 端口暴露出来， 允许外部连接这个端口。</li>
</ul>
<p>有了 <code class="notranslate">Dockerfile</code> 文件以后，就可以使用 <code class="notranslate">docker image build</code> 命令创建 <code class="notranslate">image</code> 文件了。</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">$ docker image build -t koa-demo <span class="pl-c1">.</span>
<span class="pl-c"><span class="pl-c">#</span> 或者</span>
$ docker image build -t koa-demo:0.0.1 <span class="pl-c1">.</span></pre></div>
<p>上面命令，<code class="notranslate">-t</code> 参数用来指定 <code class="notranslate">image</code> 文件的名字，后面还可以用冒号指定标签。如果不指定，默认的标签就是 <code class="notranslate">latest</code>。注意后面有个 <code class="notranslate">.</code>，表示 Dockerfile 文件所在的路径为当前路径</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">docker run --name koa-demo-name --rm -d -p 9066:3000 koa-demo:latest
<span class="pl-c"><span class="pl-c">#</span> 或者</span>
docker run --name koa-demo-name --rm -d -p 9066:3000 koa-demo:0.0.1</pre></div>
<p>上面命令，将刚创建的 <code class="notranslate">koa-demo</code> 景象跑起来，命令的 <code class="notranslate">--rm</code> 参数，在容器终止运行后自动删除容器文件。</p>
<h3>发布自己的镜像</h3>
<p><a href="https://github.com/jaywcjlove/docker-tutorial#%E5%8F%91%E5%B8%83%E8%87%AA%E5%B7%B1%E7%9A%84%E9%95%9C%E5%83%8F"></a></p>
<ol>
<li>在<a href="https://www.docker.com/" rel="nofollow">Docker</a> 注册账户，发布的镜像都在<a href="https://cloud.docker.com/repository/list" rel="nofollow">这个页面里</a>展示</li>
<li>将上面做的镜像<code class="notranslate">nginx</code>，起个新的名字<code class="notranslate">nginx-test</code></li>
</ol>
<div class="highlight highlight-source-shell"><pre class="notranslate">docker tag wcjiang/nginx:v1.2.1 wcjiang/nginx-test:lastest</pre></div>
<ol start="3">
<li>登录docker</li>
</ol>
<pre class="notranslate"><code class="notranslate">docker login
</code></pre>
<ol start="4">
<li>上传<code class="notranslate">nginx-test</code>镜像</li>
</ol>
<div class="highlight highlight-source-shell"><pre class="notranslate">docker push wcjiang/nginx-test:lastest
<span class="pl-c"><span class="pl-c">#</span> The push refers to a repository [docker.io/wcjiang/nginx-test]</span>
<span class="pl-c"><span class="pl-c">#</span> 2f5c6a3c22e3: Mounted from wcjiang/nginx</span>
<span class="pl-c"><span class="pl-c">#</span> cf516324493c: Mounted from wcjiang/nginx</span>
<span class="pl-c"><span class="pl-c">#</span> lastest: digest: sha256:73ae804b2c60327d1269aa387cf782f664bc91da3180d10dbd49027d7adaa789 size: 736</span></pre></div>
<h3>镜像中安装软件</h3>
<p><a href="https://github.com/jaywcjlove/docker-tutorial#%E9%95%9C%E5%83%8F%E4%B8%AD%E5%AE%89%E8%A3%85%E8%BD%AF%E4%BB%B6"></a></p>
<p>通常情况下，使用docker官方镜像，如 mysql镜像，默认情况下镜像中啥软件也没有，通过下面命令安装你所需要的软件：</p>
<div class="highlight highlight-source-shell"><pre class="notranslate"><span class="pl-c"><span class="pl-c">#</span> 第一次需要运行这个命令，确保源的索引是最新的</span>
<span class="pl-c"><span class="pl-c">#</span> 同步 /etc/apt/sources.list 和 /etc/apt/sources.list.d 中列出的源的索引</span>
apt-get update
<span class="pl-c"><span class="pl-c">#</span> 做过上面更新同步之后，可以运行下面的命令了</span>
apt-get install vim</pre></div>
<p>如果你安装了CentOS或者Ubuntu系统可以进入系统安装相关软件</p>
<div class="highlight highlight-source-shell"><pre class="notranslate"><span class="pl-c"><span class="pl-c">#</span> 进入到centos7镜像系统</span>
docker run -i -t centos:7 /bin/bash
yum update
yum install vim</pre></div>
<h2>容器管理</h2>
<p><a href="https://github.com/jaywcjlove/docker-tutorial#%E5%AE%B9%E5%99%A8%E7%AE%A1%E7%90%86"></a></p>
<p>容器就像一个类的实例</p>
<div class="highlight highlight-source-shell"><pre class="notranslate"><span class="pl-c"><span class="pl-c">#</span> 列出本机正在运行的容器</span>
docker container ls
<span class="pl-c"><span class="pl-c">#</span> 列出本机所有容器，包括终止运行的容器</span>
docker container ls --all
docker start [containerID/Names] <span class="pl-c"><span class="pl-c">#</span> 启动容器</span>
docker stop [containerID/Names]  <span class="pl-c"><span class="pl-c">#</span> 停止容器</span>
docker rm [containerID/Names]    <span class="pl-c"><span class="pl-c">#</span> 删除容器</span>
docker logs [containerID/Names]  <span class="pl-c"><span class="pl-c">#</span> 查看日志</span>
docker <span class="pl-c1">exec</span> -it [containerID/Names] /bin/bash  <span class="pl-c"><span class="pl-c">#</span> 进入容器</span>

<span class="pl-c"><span class="pl-c">#</span> 从正在运行的 Docker 容器里面，将文件拷贝到本机，注意后面有个【点】拷贝到当前目录</span>
docker container cp [containID]:[/path/to/file] <span class="pl-c1">.</span>

docker run centos <span class="pl-c1">echo</span> <span class="pl-s"><span class="pl-pds">"</span>hello world<span class="pl-pds">"</span></span>  <span class="pl-c"><span class="pl-c">#</span> 在docker容器中运行hello world!</span>
docker run centos yum install -y wget <span class="pl-c"><span class="pl-c">#</span> 在docker容器中，安装wget软件</span>
docker ps                             <span class="pl-c"><span class="pl-c">#</span> 列出包括未运行的容器</span>
docker ps -a                          <span class="pl-c"><span class="pl-c">#</span> 查看所有容器(包括正在运行和已停止的)</span>
docker logs my-nginx                  <span class="pl-c"><span class="pl-c">#</span> 查看 my-nginx 容器日志</span>

docker run -i -t centos /bin/bash     <span class="pl-c"><span class="pl-c">#</span> 启动一个容器</span>
docker inspect centos                 <span class="pl-c"><span class="pl-c">#</span> 检查运行中的镜像</span>
docker commit 8bd centos              <span class="pl-c"><span class="pl-c">#</span> 保存对容器的修改</span>
docker commit -m <span class="pl-s"><span class="pl-pds">"</span>n changed<span class="pl-pds">"</span></span> my-nginx my-nginx-image <span class="pl-c"><span class="pl-c">#</span> 使用已经存在的容器创建一个镜像</span>
docker inspect -f {{.State.Pid}} 44fc0f0582d9        <span class="pl-c"><span class="pl-c">#</span> 获取id为 44fc0f0582d9 的PID进程编号</span>
<span class="pl-c"><span class="pl-c">#</span> 下载指定版本容器镜像</span>
docker pull gitlab/gitlab-ce:11.2.3-ce.0</pre></div>
<h3>容器服务管理</h3>
<p><a href="https://github.com/jaywcjlove/docker-tutorial#%E5%AE%B9%E5%99%A8%E6%9C%8D%E5%8A%A1%E7%AE%A1%E7%90%86"></a></p>
<div class="highlight highlight-source-shell"><pre class="notranslate">docker run -itd --name my-nginx2 nginx  <span class="pl-c"><span class="pl-c">#</span> 通过nginx镜像，【创建】容器名为 my-nginx2 的容器</span>
docker start my-nginx --restart=always  <span class="pl-c"><span class="pl-c">#</span> 【启动策略】一个已经存在的容器启动添加策略</span>
    <span class="pl-c"><span class="pl-c">#</span> no - 容器不重启</span>
    <span class="pl-c"><span class="pl-c">#</span> on-failure - 容器推出状态非0时重启</span>
    <span class="pl-c"><span class="pl-c">#</span> always - 始终重启</span>
docker start my-nginx             <span class="pl-c"><span class="pl-c">#</span> 【启动】一个已经存在的容器</span>
docker restart my-nginx           <span class="pl-c"><span class="pl-c">#</span> 【重启】容器</span>
docker stop my-nginx              <span class="pl-c"><span class="pl-c">#</span> 【停止运行】一个容器</span>
docker <span class="pl-c1">kill</span> my-nginx              <span class="pl-c"><span class="pl-c">#</span> 【杀死】一个运行中的容器</span>
docker rename my-nginx new-nginx  <span class="pl-c"><span class="pl-c">#</span> 【重命名】容器</span>
docker rm new-nginx               <span class="pl-c"><span class="pl-c">#</span> 【删除】容器</span></pre></div>
<h3>进入容器</h3>
<p><a href="https://github.com/jaywcjlove/docker-tutorial#%E8%BF%9B%E5%85%A5%E5%AE%B9%E5%99%A8"></a></p>
<ol>
<li>创建一个守护状态的 Docker 容器</li>
</ol>
<div class="highlight highlight-source-shell"><pre class="notranslate">docker run -itd my-nginx /bin/bash</pre></div>
<ol start="2">
<li>使用<code class="notranslate">docker ps</code>查看到该容器信息</li>
</ol>
<div class="highlight highlight-source-shell"><pre class="notranslate">docker ps
<span class="pl-c"><span class="pl-c">#</span> CONTAINER ID  IMAGE  COMMAND      CREATED          STATUS          PORTS    NAMES</span>
<span class="pl-c"><span class="pl-c">#</span> 6bd0496da64f  nginx  "/bin/bash"  20 seconds ago   Up 18 seconds   80/tcp   high_shirley</span></pre></div>
<ol start="3">
<li>使用<code class="notranslate">docker exec</code>命令进入一个已经在运行的容器</li>
</ol>
<div class="highlight highlight-source-shell"><pre class="notranslate">docker <span class="pl-c1">exec</span> -it 6bd0496da64f /bin/bash</pre></div>
<p>通常有下面几种方式进入Docker的容器，推荐使用 <code class="notranslate">exec</code>，使用 <code class="notranslate">attach</code> 一直进入失败。</p>
<ul>
<li>使用<code class="notranslate">docker attach</code></li>
<li>使用<code class="notranslate">SSH</code> <a href="http://www.oschina.net/translate/why-you-dont-need-to-run-sshd-in-docker?cmp" rel="nofollow">为什么不需要在 Docker 容器中运行 sshd</a></li>
<li>使用<code class="notranslate">nsenter</code>进入Docker容器，<a href="https://github.com/jpetazzo/nsenter">nsenter官方仓库</a></li>
<li>使用<code class="notranslate">docker exec</code>，在<code class="notranslate">1.3.*</code>之后提供了一个新的命令<code class="notranslate">exec</code>用于进入容器</li>
</ul>
<h2>文件拷贝</h2>
<p><a href="https://github.com/jaywcjlove/docker-tutorial#%E6%96%87%E4%BB%B6%E6%8B%B7%E8%B4%9D"></a></p>
<p>从主机复制到容器 <code class="notranslate">sudo docker cp host_path containerID:container_path</code><br>
从容器复制到主机 <code class="notranslate">sudo docker cp containerID:container_path host_path</code></p>
<h2>Docker私有仓库搭建</h2>
<p><a href="https://github.com/jaywcjlove/docker-tutorial#docker%E7%A7%81%E6%9C%89%E4%BB%93%E5%BA%93%E6%90%AD%E5%BB%BA"></a></p>
<p>通过官方提供的私有仓库镜像<code class="notranslate">registry</code>来搭建私有仓库。通过 <a href="https://humpback.github.io/" rel="nofollow">humpback</a> 快速搭建轻量级的Docker容器云管理平台。关于仓库配置说明请参见<a href="https://github.com/docker/distribution/blob/master/docs/configuration.md">configuration.md</a></p>
<blockquote>
<p><g-emoji class="g-emoji" alias="warning">⚠️</g-emoji> 注意：也可以通过部署管理工具 <code class="notranslate">Harbor</code> 来部署 <code class="notranslate">registry</code></p>
</blockquote>
<p>除了 <a href="https://github.com/goharbor/harbor">Harbor</a> 还有 <a href="https://github.com/humpback/humpback">humpback</a> 和 <a href="https://github.com/rancher/rancher">rancher</a></p>
<h3><code class="notranslate">registry</code></h3>
<p><a href="https://github.com/jaywcjlove/docker-tutorial#registry"></a></p>
<div class="highlight highlight-source-shell"><pre class="notranslate">docker pull registry:2.6.2</pre></div>
<p>创建容器并运行，创建成功之后，可访问 <code class="notranslate">http://192.168.99.100:7000/v2/</code>，来检查仓库是否正常运行，当返回 <code class="notranslate">{}</code> 时，表示部署成功。</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">docker run -d \
  -p 5000:5000 \
  --restart=always \
  --name registry \
  registry:2

<span class="pl-c"><span class="pl-c">#</span> 自定义存储位置</span>
docker run -d \
  -p 5000:5000 \
  --restart=always \
  --name registry \
  -v <span class="pl-smi">$HOME</span>/_docker/registry:/var/lib/registry \
  registry:2

docker run -d -p 5000:5000 --restart=always --name registry \
    -v <span class="pl-s"><span class="pl-pds">`</span>pwd<span class="pl-pds">`</span></span>/config.yml:/etc/docker/registry/config.yml \
    registry:2</pre></div>
<p>推送镜像到私有仓库</p>
<div class="highlight highlight-source-shell"><pre class="notranslate"><span class="pl-c"><span class="pl-c">#</span> 从官方仓库拉取一个镜像</span>
docker pull nginx:1.13
<span class="pl-c"><span class="pl-c">#</span> 为镜像 `nginx:1.13` 创建一个新标签 `192.168.31.69:7000/test-nginx:1.13`</span>
docker tag nginx:latest 192.168.31.69:5000/test-nginx:1.13
<span class="pl-c"><span class="pl-c">#</span> 推送到私有仓库中</span>
docker push 192.168.31.69:5000/test-nginx:1.13
<span class="pl-c"><span class="pl-c">#</span> The push refers to a repository [192.168.99.100:7000/test-nginx]</span>
<span class="pl-c"><span class="pl-c">#</span> Get https://192.168.99.100:7000/v1/_ping: http: server gave HTTP response to HTTPS client</span></pre></div>
<p>在推送到的时候报错误，默认是使用 <code class="notranslate">https</code> 提交，这个搭建的默认使用的是 <code class="notranslate">http</code>，解决方法两个：</p>
<ol>
<li>创建一个 <code class="notranslate">https</code> 映射</li>
<li>将仓库地址加入到不安全的仓库列表中</li>
</ol>
<p>我们使用第二种方法，加入到不安全的仓库列表中，修改docker配置文件 <code class="notranslate">vi /etc/docker/daemon.json</code> 添加 <code class="notranslate">insecure-registries</code> 配置信息，如果 <a href="https://docs.docker.com/engine/reference/commandline/dockerd/#daemon-configuration-file" rel="nofollow">daemon.json</a> 文件不存在可以创建，关键配置项，将仓库将入到不安全的仓库列表中。</p>
<div class="highlight highlight-source-js"><pre class="notranslate"><span class="pl-kos">{</span>
  <span class="pl-s">"insecure-registries"</span>:<span class="pl-kos">[</span>
    <span class="pl-s">"192.168.31.69:5000"</span>
  <span class="pl-kos">]</span>
<span class="pl-kos">}</span></pre></div>
<blockquote>
<p>如果是 macOS 可以通过 docker 客户端，<code class="notranslate">Preferences</code> =&gt; <code class="notranslate">Advanced</code> =&gt; <code class="notranslate">添加配置</code> =&gt; <code class="notranslate">Apply &amp; Restart</code>，重启docker就可以了。</p>
</blockquote>
<p>重启服务 <code class="notranslate">service docker restart</code>，默认情况下 push 是会报如下错误的：</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">docker push 192.168.99.100:7000/test-nginx:1.13
<span class="pl-c"><span class="pl-c">#</span> The push refers to a repository [192.168.99.100:7000/test-nginx]</span>
<span class="pl-c"><span class="pl-c">#</span> a1a53f8d99b5: Retrying in 1 second</span>
<span class="pl-c"><span class="pl-c">#</span> ...</span>
<span class="pl-c"><span class="pl-c">#</span> received unexpected HTTP status: 500 Internal Server Error</span></pre></div>
<p>上面错误是 <code class="notranslate">SELinux</code> 强制访问控制安全系统，阻止导致的错误，通过下面方法禁用 SELinux 之后就可以 push 了。</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">setenforce 0  
getenforce   
<span class="pl-c"><span class="pl-c">#</span> Permissive  </span></pre></div>
<div class="highlight highlight-source-shell"><pre class="notranslate"><span class="pl-c"><span class="pl-c">#</span> 停止本地 registry</span>
docker container stop registry
<span class="pl-c"><span class="pl-c">#</span> 要删除容器，请使用 docker container rm</span>
docker container stop registry <span class="pl-k">&amp;&amp;</span> docker container rm -v registry
<span class="pl-c"><span class="pl-c">#</span> 自定义存储位置</span></pre></div>
<h3><code class="notranslate">Harbor</code></h3>
<p><a href="https://github.com/jaywcjlove/docker-tutorial#harbor"></a></p>
<p><a href="https://github.com/jaywcjlove/docker-tutorial/blob/master/docs/harbor.md">部署 registry 管理工具 Harbor</a></p>
<h2>Docker REST API</h2>
<p><a href="https://github.com/jaywcjlove/docker-tutorial#docker-rest-api"></a></p>
<p><code class="notranslate">Docker</code> 不仅可以通过本地命令行 <code class="notranslate">docker</code> 命令进行调用，还可以通过开启远程控制 <code class="notranslate">API</code>，使用 <code class="notranslate">HTTP</code> 调用接口来进行访问，远程控制 <code class="notranslate">Docker Daemon</code> 来做很多操作。<code class="notranslate">Docker</code> 的远程 <code class="notranslate">API</code> 服务默认监听的是 TCP <code class="notranslate">2375</code> 端口，为了保证安全，Docker 安装后默认不会启用远程 <code class="notranslate">API</code> 服务，因为这个服务默认不做权限认证。</p>
<h3>CentOS</h3>
<p><a href="https://github.com/jaywcjlove/docker-tutorial#centos"></a></p>
<p>CentOS 的开启方法比较简单，先修改配置：</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">vim /usr/lib/systemd/system/docker.service

<span class="pl-c"><span class="pl-c">#</span> 修改 `ExecStart` 配置项，默认如下：</span>
ExecStart=/usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock

<span class="pl-c"><span class="pl-c">#</span> 增加一个 `-H tcp://0.0.0.0:2375` 选项</span>
ExecStart=/usr/bin/dockerd -H fd:// -H tcp://0.0.0.0:2375 --containerd=/run/containerd/containerd.sock</pre></div>
<p>如果是内网生产环境，也可以将 <code class="notranslate">0.0.0.0</code> 改为内网 IP。同样的，<code class="notranslate">2375</code> 端口也可以修改。但是这样可能还有一个问题，无法在命令行使用 <code class="notranslate">docker</code> 命令了，还需要添加 <code class="notranslate">sock</code> 选项：<code class="notranslate">-H unix:///var/run/docker.sock</code>，最后为：</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">ExecStart=/usr/bin/dockerd -H fd:// -H unix:///var/run/docker.sock -H tcp://10.105.3.115:2375 --containerd=/run/containerd/containerd.sock</pre></div>
<p>修改完配置之后需要重启 Docker 服务：</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">systemctl daemon-reload
systemctl restart docker
sudo service docker restart</pre></div>
<p>重启完成后，可以使用 netstat 查看端口是否监听来确认是否成功：</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">[root@VM-3-115-centos <span class="pl-k">~</span>]<span class="pl-c"><span class="pl-c">#</span> netstat -nutlp | grep 2375</span>
tcp   0   0 10.105.3.115:2375   0.0.0.0:<span class="pl-k">*</span>     LISTEN    32316/dockerd</pre></div>
<h3>MacOS</h3>
<p><a href="https://github.com/jaywcjlove/docker-tutorial#macos"></a></p>
<p>在 Mac 下无法直接修改配置文件来开启远程 API 服务，后来在 <a href="https://github.com/docker/for-mac"><code class="notranslate">docker/for-mac</code></a> 的 <a href="https://github.com/docker/for-mac/issues/770" data-hovercard-type="issue" data-hovercard-url="/docker/for-mac/issues/770/hovercard"><code class="notranslate">issue</code></a> 中得到了解决方案。</p>
<p>可以运行一个 <a href="https://hub.docker.com/r/bobrik/socat" rel="nofollow"><code class="notranslate">bobrik/socat</code></a> 容器，将 <code class="notranslate">unix socket</code> 上的 Docker API 转发到 MacOS 上指定的端口中：</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">docker run -d -v /var/run/docker.sock:/var/run/docker.sock -p 127.0.0.1:2375:2375 bobrik/socat TCP-LISTEN:2375,fork UNIX-CONNECT:/var/run/docker.sock</pre></div>
<h3>测试</h3>
<p><a href="https://github.com/jaywcjlove/docker-tutorial#%E6%B5%8B%E8%AF%95"></a></p>
<p>启用成功后，可以进行一些测试，例如直接使用浏览器访问 info 和 version 等页面获取信息。</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">http://127.0.0.1:2375/info
http://127.0.0.1:2375/version</pre></div>
<p>下面可测试 docker 是否启动了</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">curl -s --unix-socket /var/run/docker.sock http://dummy/containers/json
<span class="pl-c"><span class="pl-c">#</span># 或者使用下面命令</span>
docker info</pre></div>
<h2>使用 Docker 实战</h2>
<p><a href="https://github.com/jaywcjlove/docker-tutorial#%E4%BD%BF%E7%94%A8-docker-%E5%AE%9E%E6%88%98"></a></p>
<blockquote>
<p>⚠文件挂载注意：docker 禁止用主机上不存在的文件挂载到 container 中已经存在的文件</p>
</blockquote>
<div class="highlight highlight-source-shell"><pre class="notranslate">-d, --detach=false      <span class="pl-c"><span class="pl-c">#</span> 指定容器运行于前台还是后台，默认为false   </span>
-i, --interactive=false <span class="pl-c"><span class="pl-c">#</span> 打开STDIN，用于控制台交互  </span>
-t, --tty=false         <span class="pl-c"><span class="pl-c">#</span> 分配tty设备，该可以支持终端登录，默认为false  </span>
-u, --user=<span class="pl-s"><span class="pl-pds">"</span><span class="pl-pds">"</span></span>           <span class="pl-c"><span class="pl-c">#</span> 指定容器的用户  </span>
-a, --attach=[]         <span class="pl-c"><span class="pl-c">#</span> 登录容器（必须是以docker run -d启动的容器）</span>
-w, --workdir=<span class="pl-s"><span class="pl-pds">"</span><span class="pl-pds">"</span></span>        <span class="pl-c"><span class="pl-c">#</span> 指定容器的工作目录 </span>
-c, --cpu-shares=0      <span class="pl-c"><span class="pl-c">#</span> 设置容器CPU权重，在CPU共享场景使用  </span>
-e, --env=[]            <span class="pl-c"><span class="pl-c">#</span> 指定环境变量，容器中可以使用该环境变量  </span>
-m, --memory=<span class="pl-s"><span class="pl-pds">"</span><span class="pl-pds">"</span></span>         <span class="pl-c"><span class="pl-c">#</span> 指定容器的内存上限  </span>
-P, --publish-all=false <span class="pl-c"><span class="pl-c">#</span> 指定容器暴露的端口  </span>
-p, --publish=[]        <span class="pl-c"><span class="pl-c">#</span> 指定容器暴露的端口 </span>
-h, --hostname=<span class="pl-s"><span class="pl-pds">"</span><span class="pl-pds">"</span></span>       <span class="pl-c"><span class="pl-c">#</span> 指定容器的主机名  </span>
-v, --volume=[]         <span class="pl-c"><span class="pl-c">#</span> 给容器挂载存储卷，挂载到容器的某个目录  </span>
--volumes-from=[]       <span class="pl-c"><span class="pl-c">#</span> 给容器挂载其他容器上的卷，挂载到容器的某个目录</span>
--cap-add=[]            <span class="pl-c"><span class="pl-c">#</span> 添加权限，权限清单详见：http://linux.die.net/man/7/capabilities  </span>
--cap-drop=[]           <span class="pl-c"><span class="pl-c">#</span> 删除权限，权限清单详见：http://linux.die.net/man/7/capabilities  </span>
--cidfile=<span class="pl-s"><span class="pl-pds">"</span><span class="pl-pds">"</span></span>            <span class="pl-c"><span class="pl-c">#</span> 运行容器后，在指定文件中写入容器PID值，一种典型的监控系统用法  </span>
--cpuset=<span class="pl-s"><span class="pl-pds">"</span><span class="pl-pds">"</span></span>             <span class="pl-c"><span class="pl-c">#</span> 设置容器可以使用哪些CPU，此参数可以用来容器独占CPU  </span>
--device=[]             <span class="pl-c"><span class="pl-c">#</span> 添加主机设备给容器，相当于设备直通  </span>
--dns=[]                <span class="pl-c"><span class="pl-c">#</span> 指定容器的dns服务器  </span>
--dns-search=[]         <span class="pl-c"><span class="pl-c">#</span> 指定容器的dns搜索域名，写入到容器的/etc/resolv.conf文件  </span>
--entrypoint=<span class="pl-s"><span class="pl-pds">"</span><span class="pl-pds">"</span></span>         <span class="pl-c"><span class="pl-c">#</span> 覆盖image的入口点  </span>
--env-file=[]           <span class="pl-c"><span class="pl-c">#</span> 指定环境变量文件，文件格式为每行一个环境变量  </span>
--expose=[]             <span class="pl-c"><span class="pl-c">#</span> 指定容器暴露的端口，即修改镜像的暴露端口  </span>
--link=[]               <span class="pl-c"><span class="pl-c">#</span> 指定容器间的关联，使用其他容器的IP、env等信息  </span>
--lxc-conf=[]           <span class="pl-c"><span class="pl-c">#</span> 指定容器的配置文件，只有在指定--exec-driver=lxc时使用  </span>
--name=<span class="pl-s"><span class="pl-pds">"</span><span class="pl-pds">"</span></span>               <span class="pl-c"><span class="pl-c">#</span> 指定容器名字，后续可以通过名字进行容器管理，links特性需要使用名字  </span>
--net=<span class="pl-s"><span class="pl-pds">"</span>bridge<span class="pl-pds">"</span></span>          <span class="pl-c"><span class="pl-c">#</span> 容器网络设置:</span>
                            <span class="pl-c"><span class="pl-c">#</span> bridge 使用docker daemon指定的网桥     </span>
                            <span class="pl-c"><span class="pl-c">#</span> host 	//容器使用主机的网络  </span>
                            <span class="pl-c"><span class="pl-c">#</span> container:NAME_or_ID  &gt;//使用其他容器的网路，共享IP和PORT等网络资源  </span>
                            <span class="pl-c"><span class="pl-c">#</span> none 容器使用自己的网络（类似--net=bridge），但是不进行配置 </span>
--privileged=false      <span class="pl-c"><span class="pl-c">#</span> 指定容器是否为特权容器，特权容器拥有所有的capabilities  </span>
--restart=<span class="pl-s"><span class="pl-pds">"</span>no<span class="pl-pds">"</span></span>          <span class="pl-c"><span class="pl-c">#</span> 指定容器停止后的重启策略:</span>
                            <span class="pl-c"><span class="pl-c">#</span> no：容器退出时不重启  </span>
                            <span class="pl-c"><span class="pl-c">#</span> on-failure：容器故障退出（返回值非零）时重启 </span>
                            <span class="pl-c"><span class="pl-c">#</span> always：容器退出时总是重启  </span>
--rm=false              <span class="pl-c"><span class="pl-c">#</span> 指定容器停止后自动删除容器(不支持以docker run -d启动的容器)  </span>
--sig-proxy=true        <span class="pl-c"><span class="pl-c">#</span> 设置由代理接受并处理信号，但是SIGCHLD、SIGSTOP和SIGKILL不能被代理</span></pre></div>
<h3><code class="notranslate">Nginx</code></h3>
<p><a href="https://github.com/jaywcjlove/docker-tutorial#nginx"></a></p>
<p><a href="https://github.com/jaywcjlove/docker-tutorial/blob/master/docs/nginx.md">在 docker 中部署 Nginx</a></p>
<h3><code class="notranslate">MySQL</code></h3>
<p><a href="https://github.com/jaywcjlove/docker-tutorial#mysql"></a></p>
<p><a href="https://github.com/jaywcjlove/docker-tutorial/blob/master/docs/mysql.md">在 docker 中部署 MySQL</a></p>
<h3><code class="notranslate">PostgreSQL</code></h3>
<p><a href="https://github.com/jaywcjlove/docker-tutorial#postgresql"></a></p>
<p><a href="https://github.com/jaywcjlove/docker-tutorial/blob/master/docs/postgres.md">在 docker 中部署 PostgreSQL</a></p>
<h3><code class="notranslate">Redis</code></h3>
<p><a href="https://github.com/jaywcjlove/docker-tutorial#redis"></a></p>
<p><a href="https://github.com/jaywcjlove/docker-tutorial/blob/master/docs/redis.md">在 docker 中部署 Redis</a></p>
<h3><code class="notranslate">Elasticsearch</code></h3>
<p><a href="https://github.com/jaywcjlove/docker-tutorial#elasticsearch"></a></p>
<p><a href="https://github.com/jaywcjlove/docker-tutorial/blob/master/docs/elasticsearch.md">在 docker 中部署 Elasticsearch</a></p>
<h3><code class="notranslate">Gitlab</code></h3>
<p><a href="https://github.com/jaywcjlove/docker-tutorial#gitlab"></a></p>
<p><a href="https://github.com/jaywcjlove/docker-tutorial/blob/master/docs/gitlab/README.md">在 docker 中部署 Gitlab</a></p>
<h3><code class="notranslate">Rocket.Chat</code></h3>
<p><a href="https://github.com/jaywcjlove/docker-tutorial#rocketchat"></a></p>
<p><a href="https://github.com/jaywcjlove/docker-tutorial/blob/master/docs/rocket.chat/README.md">在 docker 中部署 Gitlab</a></p>
<h3><code class="notranslate">Rancher</code></h3>
<p><a href="https://github.com/jaywcjlove/docker-tutorial#rancher"></a></p>
<p><a href="https://github.com/jaywcjlove/docker-tutorial/blob/master/docs/rancher.md">在 docker 中部署 Rancher</a></p>
<h3><code class="notranslate">Portainer</code></h3>
<p><a href="https://github.com/jaywcjlove/docker-tutorial#portainer"></a></p>
<p><a href="https://github.com/jaywcjlove/docker-tutorial/blob/master/docs/portainer.md">在 docker 中部署 Portainer</a></p>
<h3><code class="notranslate">Sourcegraph</code></h3>
<p><a href="https://github.com/jaywcjlove/docker-tutorial#sourcegraph"></a></p>
<p><a href="https://github.com/jaywcjlove/docker-tutorial/blob/master/docs/sourcegraph/README.md">在 docker 中部署 Sourcegraph</a></p>
<h3><code class="notranslate">Mattermost</code></h3>
<p><a href="https://github.com/jaywcjlove/docker-tutorial#mattermost"></a></p>
<p><a href="https://github.com/jaywcjlove/docker-tutorial/blob/master/docs/mattermost.md">在 docker 中部署 Mattermost</a></p>
<h3><code class="notranslate">SeaweedFS</code></h3>
<p><a href="https://github.com/jaywcjlove/docker-tutorial#seaweedfs"></a></p>
<p><a href="https://github.com/jaywcjlove/docker-tutorial/blob/master/docs/seaweedfs/README.md">在 docker 中部署 SeaweedFS</a></p>
<h3><code class="notranslate">NPS</code></h3>
<p><a href="https://github.com/jaywcjlove/docker-tutorial#nps"></a></p>
<p><a href="https://github.com/jaywcjlove/docker-tutorial/blob/master/docs/nps/README.md">在 docker 中搭建内网穿透服务器，带WEB管理</a></p>
<h3><code class="notranslate">Penpot</code></h3>
<p><a href="https://github.com/jaywcjlove/docker-tutorial#penpot"></a></p>
<p><a href="https://github.com/jaywcjlove/docker-tutorial/blob/master/docs/penpot.md">在 docker 中部署 Penpot</a></p>
<h3><code class="notranslate">Navidrome</code></h3>
<p><a href="https://github.com/jaywcjlove/docker-tutorial#navidrome"></a></p>
<p><a href="https://github.com/jaywcjlove/docker-tutorial/blob/master/docs/navidrome.md">在 docker 中部署 Navidrome</a></p>
<h3><code class="notranslate">Jenkins</code></h3>
<p><a href="https://github.com/jaywcjlove/docker-tutorial#jenkins"></a></p>
<p><a href="https://github.com/jaywcjlove/docker-tutorial/blob/master/docs/jenkins/README.md">在 docker 中部署 Jenkins</a></p>
<h3><code class="notranslate">Humpback</code></h3>
<p><a href="https://github.com/jaywcjlove/docker-tutorial#humpback"></a></p>
<p>首先创建放持久化数据文件夹，<code class="notranslate">mkdir -p /opt/app/humpback-web</code>，里面存放持久化数据文件，会存储站点管理和分组信息，启动后请妥善保存。</p>
<div class="highlight highlight-source-shell"><pre class="notranslate"><span class="pl-c"><span class="pl-c">#</span> 创建放持久化数据文件夹</span>
mkdir -p /opt/app/humpback-web
<span class="pl-c"><span class="pl-c">#</span> 下载humpback-web镜像到本地</span>
docker pull humpbacks/humpback-web:1.0.0
<span class="pl-c"><span class="pl-c">#</span> 启动 humpback-web 容器，将容器命名为 humpback-web</span>
docker run -d --net=host --restart=always \
 -e HUMPBACK_LISTEN_PORT=7001 \
 -v /opt/app/humpback-web/dbFiles:/humpback-web/dbFiles \
 --name humpback-web \
 humpbacks/humpback-web:1.0.0</pre></div>
<p>访问站点，打开浏览器输入：<a href="http://192.168.99.100:7001/" rel="nofollow">http://192.168.99.100:7001</a> ，默认账户：<code class="notranslate">admin</code> 密码：<code class="notranslate">123456</code></p>
<h3><code class="notranslate">Seafile</code></h3>
<p><a href="https://github.com/jaywcjlove/docker-tutorial#seafile"></a></p>
<div class="highlight highlight-source-shell"><pre class="notranslate">docker run -d --name seafile \
  -e SEAFILE_SERVER_HOSTNAME=seafile.example.com \
  -v /opt/seafile-data:/shared \
  -p 80:80 \
  seafileltd/seafile:latest</pre></div>
<div class="highlight highlight-source-shell"><pre class="notranslate">docker run -d --name seafile \
  -e SEAFILE_SERVER_HOSTNAME=pan.example.com \
  -e SEAFILE_ADMIN_EMAIL=wcj@example.com \
  -e SEAFILE_ADMIN_PASSWORD=wcj@example.com \
  -v <span class="pl-smi">$HOME</span>/_docker/seafile-data:/shared \
  -p 80:80 \
  seafileltd/seafile:latest</pre></div>
<h3>更多</h3>
<p><a href="https://github.com/jaywcjlove/docker-tutorial#%E6%9B%B4%E5%A4%9A"></a></p>
<p><a href="https://github.com/jaywcjlove/docker-tutorial/blob/master/docs">更多 docker 工具部署，在 docker 目录中</a></p>
<h2>卸载旧的版本</h2>
<p><a href="https://github.com/jaywcjlove/docker-tutorial#%E5%8D%B8%E8%BD%BD%E6%97%A7%E7%9A%84%E7%89%88%E6%9C%AC"></a></p>
<p>移除旧的版本</p>
<div class="highlight highlight-source-shell"><pre class="notranslate">$ sudo yum remove docker \
  docker-client \
  docker-client-latest \
  docker-common \
  docker-latest \
  docker-latest-logrotate \
  docker-logrotate \
  docker-selinux \
  docker-engine-selinux \
  docker-engine</pre></div>
<h2>错误处理</h2>
<p><a href="https://github.com/jaywcjlove/docker-tutorial#%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86"></a></p>
<p>Create more free space in thin pool or use dm.min_free_space option to change behavior</p>
<blockquote>
<p>特别慎用，东西都没有了，注意备份哦。<a href="https://github.com/moby/moby/issues/3182#issuecomment-256532928" data-hovercard-type="issue" data-hovercard-url="/moby/moby/issues/3182/hovercard">moby/moby#3182 (comment)</a></p>
</blockquote>
<p><strong>镜像拉不下来</strong></p>
<p>修改 Docker <code class="notranslate">daemon.json</code> 配置 macOS: <code class="notranslate">/etc/docker/daemon.json</code>，Linux: <code class="notranslate">~/.docker/daemon.json</code></p>
<div class="highlight highlight-source-js"><pre class="notranslate"><span class="pl-kos">{</span>
  <span class="pl-s">"registry-mirrors"</span>:<span class="pl-kos">[</span>
     <span class="pl-s">"https://docker.mirrors.ustc.edu.cn"</span><span class="pl-kos">,</span>
     <span class="pl-s">"https://hub-mirror.c.163.com"</span><span class="pl-kos">,</span>
     <span class="pl-s">"https://mirror.baidubce.com"</span><span class="pl-kos">,</span>
     <span class="pl-s">"https://registry.docker-cn.com"</span>
  <span class="pl-kos">]</span><span class="pl-kos">,</span>
  <span class="pl-s">"insecure-registries"</span>: <span class="pl-kos">[</span>
     <span class="pl-s">"192.168.188.111:2021"</span>
  <span class="pl-kos">]</span>
<span class="pl-kos">}</span></pre></div>
<h2>参考资料</h2>
<p><a href="https://github.com/jaywcjlove/docker-tutorial#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99"></a></p>
<h3>官方英文资源</h3>
<p><a href="https://github.com/jaywcjlove/docker-tutorial#%E5%AE%98%E6%96%B9%E8%8B%B1%E6%96%87%E8%B5%84%E6%BA%90"></a></p>
<ul>
<li>Docker官网：<a href="http://www.docker.com/" rel="nofollow">http://www.docker.com</a></li>
<li>Docker windows入门：<a href="https://docs.docker.com/windows/" rel="nofollow">https://docs.docker.com/windows/</a></li>
<li>Docker Linux 入门：<a href="https://docs.docker.com/linux/" rel="nofollow">https://docs.docker.com/linux/</a></li>
<li>Docker mac 入门：<a href="https://docs.docker.com/mac/" rel="nofollow">https://docs.docker.com/mac/</a></li>
<li>Docker 用户指引：<a href="https://docs.docker.com/engine/userguide/" rel="nofollow">https://docs.docker.com/engine/userguide/</a></li>
<li>Docker 官方博客：<a href="http://blog.docker.com/" rel="nofollow">http://blog.docker.com/</a></li>
<li>Docker Hub: <a href="https://hub.docker.com/" rel="nofollow">https://hub.docker.com/</a></li>
<li>Docker开源： <a href="https://www.docker.com/open-source" rel="nofollow">https://www.docker.com/open-source</a></li>
</ul>
<h3>中文资源</h3>
<p><a href="https://github.com/jaywcjlove/docker-tutorial#%E4%B8%AD%E6%96%87%E8%B5%84%E6%BA%90"></a></p>
<ul>
<li>Docker中文网站：<a href="http://www.docker.org.cn/" rel="nofollow">http://www.docker.org.cn</a></li>
<li>Docker中文文档：<a href="http://www.dockerinfo.net/document" rel="nofollow">http://www.dockerinfo.net/document</a></li>
<li>Docker安装手册：<a href="http://www.docker.org.cn/book/install.html" rel="nofollow">http://www.docker.org.cn/book/install.html</a></li>
<li>一小时Docker教程 ：<a href="https://blog.csphere.cn/archives/22" rel="nofollow">https://blog.csphere.cn/archives/22</a></li>
<li>Docker中文指南：<a href="http://www.widuu.com/chinese_docker/index.html" rel="nofollow">http://www.widuu.com/chinese_docker/index.html</a></li>
</ul>
<h3>其它资源</h3>
<p><a href="https://github.com/jaywcjlove/docker-tutorial#%E5%85%B6%E5%AE%83%E8%B5%84%E6%BA%90"></a></p>
<ul>
<li><a href="https://jaywcjlove.github.io/reference/docs/docker.html" rel="nofollow">Docker 参考清单！</a></li>
<li><a href="https://github.com/eon01/DockerCheatSheet">Docker 快速手册！</a></li>
<li><a href="http://www.runoob.com/docker/docker-tutorial.html" rel="nofollow">Docker 教程</a></li>
<li><a href="https://www.gitbook.com/book/yeasy/docker_practice" rel="nofollow">Docker 从入门到实践</a></li>
<li><a href="http://blog.csdn.net/zhangchao19890805/article/details/52756865" rel="nofollow">MySQL Docker 单一机器上如何配置自动备份</a></li>
<li><a href="http://dockone.io/article/834" rel="nofollow">使用Docker Compose管理多个容器</a></li>
<li><a href="https://segmentfault.com/t/docker" rel="nofollow">https://segmentfault.com/t/docker</a></li>
<li><a href="https://github.com/docker/docker">https://github.com/docker/docker</a></li>
<li><a href="https://wiki.openstack.org/wiki/Docker" rel="nofollow">https://wiki.openstack.org/wiki/Docker</a></li>
<li><a href="https://wiki.archlinux.org/index.php/Docker" rel="nofollow">https://wiki.archlinux.org/index.php/Docker</a></li>
</ul></div>
<div style="font-size:small;margin-top:8px;float:right;"></div>

<button class="btn btn-block" type="button" onclick="openComments()" id="cmButton">评论</button>
<div class="comments" id="comments"></div>

</div>
    <div id="footer"><div id="footer1">Copyright © <span id="copyrightYear"></span> <a href="https://HubertHu137.github.io/Blog">Hubert的技术博客站</a></div>
<div id="footer2">
    <span id="runday"></span><span>Powered by <a href="https://meekdai.com/Gmeek.html" target="_blank">Gmeek</a></span>
</div>

<script>
var now=new Date();
document.getElementById("copyrightYear").innerHTML=now.getFullYear();

if(""!=""){
    var startSite=new Date("");
    var diff=now.getTime()-startSite.getTime();
    var diffDay=Math.floor(diff/(1000*60*60*24));
    document.getElementById("runday").innerHTML="网站运行"+diffDay+"天"+" • ";
}
</script></div>
</body>
<script>
var IconList={'sun': 'M8 10.5a2.5 2.5 0 100-5 2.5 2.5 0 000 5zM8 12a4 4 0 100-8 4 4 0 000 8zM8 0a.75.75 0 01.75.75v1.5a.75.75 0 01-1.5 0V.75A.75.75 0 018 0zm0 13a.75.75 0 01.75.75v1.5a.75.75 0 01-1.5 0v-1.5A.75.75 0 018 13zM2.343 2.343a.75.75 0 011.061 0l1.06 1.061a.75.75 0 01-1.06 1.06l-1.06-1.06a.75.75 0 010-1.06zm9.193 9.193a.75.75 0 011.06 0l1.061 1.06a.75.75 0 01-1.06 1.061l-1.061-1.06a.75.75 0 010-1.061zM16 8a.75.75 0 01-.75.75h-1.5a.75.75 0 010-1.5h1.5A.75.75 0 0116 8zM3 8a.75.75 0 01-.75.75H.75a.75.75 0 010-1.5h1.5A.75.75 0 013 8zm10.657-5.657a.75.75 0 010 1.061l-1.061 1.06a.75.75 0 11-1.06-1.06l1.06-1.06a.75.75 0 011.06 0zm-9.193 9.193a.75.75 0 010 1.06l-1.06 1.061a.75.75 0 11-1.061-1.06l1.06-1.061a.75.75 0 011.061 0z', 'moon': 'M9.598 1.591a.75.75 0 01.785-.175 7 7 0 11-8.967 8.967.75.75 0 01.961-.96 5.5 5.5 0 007.046-7.046.75.75 0 01.175-.786zm1.616 1.945a7 7 0 01-7.678 7.678 5.5 5.5 0 107.678-7.678z', 'sync': 'M1.705 8.005a.75.75 0 0 1 .834.656 5.5 5.5 0 0 0 9.592 2.97l-1.204-1.204a.25.25 0 0 1 .177-.427h3.646a.25.25 0 0 1 .25.25v3.646a.25.25 0 0 1-.427.177l-1.38-1.38A7.002 7.002 0 0 1 1.05 8.84a.75.75 0 0 1 .656-.834ZM8 2.5a5.487 5.487 0 0 0-4.131 1.869l1.204 1.204A.25.25 0 0 1 4.896 6H1.25A.25.25 0 0 1 1 5.75V2.104a.25.25 0 0 1 .427-.177l1.38 1.38A7.002 7.002 0 0 1 14.95 7.16a.75.75 0 0 1-1.49.178A5.5 5.5 0 0 0 8 2.5Z', 'home': 'M6.906.664a1.749 1.749 0 0 1 2.187 0l5.25 4.2c.415.332.657.835.657 1.367v7.019A1.75 1.75 0 0 1 13.25 15h-3.5a.75.75 0 0 1-.75-.75V9H7v5.25a.75.75 0 0 1-.75.75h-3.5A1.75 1.75 0 0 1 1 13.25V6.23c0-.531.242-1.034.657-1.366l5.25-4.2Zm1.25 1.171a.25.25 0 0 0-.312 0l-5.25 4.2a.25.25 0 0 0-.094.196v7.019c0 .138.112.25.25.25H5.5V8.25a.75.75 0 0 1 .75-.75h3.5a.75.75 0 0 1 .75.75v5.25h2.75a.25.25 0 0 0 .25-.25V6.23a.25.25 0 0 0-.094-.195Z', 'github': 'M8 0c4.42 0 8 3.58 8 8a8.013 8.013 0 0 1-5.45 7.59c-.4.08-.55-.17-.55-.38 0-.27.01-1.13.01-2.2 0-.75-.25-1.23-.54-1.48 1.78-.2 3.65-.88 3.65-3.95 0-.88-.31-1.59-.82-2.15.08-.2.36-1.02-.08-2.12 0 0-.67-.22-2.2.82-.64-.18-1.32-.27-2-.27-.68 0-1.36.09-2 .27-1.53-1.03-2.2-.82-2.2-.82-.44 1.1-.16 1.92-.08 2.12-.51.56-.82 1.28-.82 2.15 0 3.06 1.86 3.75 3.64 3.95-.23.2-.44.55-.51 1.07-.46.21-1.61.55-2.33-.66-.15-.24-.6-.83-1.23-.82-.67.01-.27.38.01.53.34.19.73.9.82 1.13.16.45.68 1.31 2.69.94 0 .67.01 1.3.01 1.49 0 .21-.15.45-.55.38A7.995 7.995 0 0 1 0 8c0-4.42 3.58-8 8-8Z', 'copy': 'M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z', 'check': 'M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z'};
var utterancesLoad=0;

let themeSettings={
    "dark": ["dark","moon","#00f0ff","dark-blue"],
    "light": ["light","sun","#ff5000","github-light"],
    "auto": ["auto","sync","","preferred-color-scheme"]
};
function changeTheme(mode, icon, color, utheme){
    document.documentElement.setAttribute("data-color-mode",mode);
    document.getElementById("themeSwitch").setAttribute("d",value=IconList[icon]);
    document.getElementById("themeSwitch").parentNode.style.color=color;
    if(utterancesLoad==1){utterancesTheme(utheme);}
}
function modeSwitch(){
    let currentMode=document.documentElement.getAttribute('data-color-mode');
    let newMode = currentMode === "light" ? "dark" : currentMode === "dark" ? "auto" : "light";
    localStorage.setItem("meek_theme", newMode);
    if(themeSettings[newMode]){
        changeTheme(...themeSettings[newMode]);
    }
}
function utterancesTheme(theme){
    const message={type:'set-theme',theme: theme};
    const iframe=document.getElementsByClassName('utterances-frame')[0];
    iframe.contentWindow.postMessage(message,'https://utteranc.es');
}
if(themeSettings[theme]){changeTheme(...themeSettings[theme]);}
console.log("\n %c Gmeek last https://github.com/Meekdai/Gmeek \n","padding:5px 0;background:#02d81d;color:#fff");
</script>

<script>
document.getElementById("pathHome").setAttribute("d",IconList["home"]);
document.getElementById("pathIssue").setAttribute("d",IconList["github"]);



function openComments(){
    cm=document.getElementById("comments");
    cmButton=document.getElementById("cmButton");
    cmButton.innerHTML="loading";
    span=document.createElement("span");
    span.setAttribute("class","AnimatedEllipsis");
    cmButton.appendChild(span);

    script=document.createElement("script");
    script.setAttribute("src","https://utteranc.es/client.js");
    script.setAttribute("repo","HubertHu137/Blog");
    script.setAttribute("issue-term","title");
    
    if(localStorage.getItem("meek_theme")=="dark"){script.setAttribute("theme","dark-blue");}
    else if(localStorage.getItem("meek_theme")=="light") {script.setAttribute("theme","github-light");}
    else{script.setAttribute("theme","preferred-color-scheme");}
    
    script.setAttribute("crossorigin","anonymous");
    script.setAttribute("async","");
    cm.appendChild(script);

    int=self.setInterval("iFrameLoading()",200);
}

function iFrameLoading(){
    var utterances=document.getElementsByClassName('utterances');
    if(utterances.length==1){
        if(utterances[0].style.height!=""){
            utterancesLoad=1;
            int=window.clearInterval(int);
            document.getElementById("cmButton").style.display="none";
            console.log("utterances Load OK");
        }
    }
}

document.addEventListener('DOMContentLoaded', () => {
    const createClipboardHTML = (codeContent, additionalClasses = '') => `
        <pre class="notranslate"><code class="notranslate">${codeContent}</code></pre>
        <div class="clipboard-container position-absolute right-0 top-0 ${additionalClasses}">
            <clipboard-copy class="ClipboardButton btn m-2 p-0" role="button" style="display: inherit;">
                <svg height="16" width="16" class="octicon octicon-copy m-2"><path d="${IconList["copy"]}"></path></svg>
                <svg height="16" width="16" class="octicon octicon-check color-fg-success m-2 d-none"><path d="${IconList["check"]}"></path></svg>
            </clipboard-copy>
            <div class="copy-feedback">Copied!</div>
        </div>
    `;

    const handleCodeElements = (selector = '') => {
        document.querySelectorAll(selector).forEach(codeElement => {
            const codeContent = codeElement.innerHTML;
            const newStructure = document.createElement('div');
            newStructure.className = 'snippet-clipboard-content position-relative overflow-auto';
            newStructure.innerHTML = createClipboardHTML(codeContent);

            const parentElement = codeElement.parentElement;
            if (selector.includes('highlight')) {
                parentElement.insertBefore(newStructure, codeElement.nextSibling);
                parentElement.removeChild(codeElement);
            } else {
                parentElement.parentElement.replaceChild(newStructure, parentElement);
            }
        });
    };

    handleCodeElements('pre.notranslate > code.notranslate');
    handleCodeElements('div.highlight > pre.notranslate');

    let currentFeedback = null;
    document.querySelectorAll('clipboard-copy').forEach(copyButton => {
        copyButton.addEventListener('click', () => {
            const codeContent = copyButton.closest('.snippet-clipboard-content').innerText;
            const tempTextArea = document.createElement('textarea');
            tempTextArea.value = codeContent;
            document.body.appendChild(tempTextArea);
            tempTextArea.select();
            document.execCommand('copy');
            document.body.removeChild(tempTextArea);

            const copyIcon = copyButton.querySelector('.octicon-copy');
            const checkIcon = copyButton.querySelector('.octicon-check');
            const copyFeedback = copyButton.nextElementSibling;

            if (currentFeedback && currentFeedback !== copyFeedback) {currentFeedback.style.display = 'none';}
            currentFeedback = copyFeedback;

            copyIcon.classList.add('d-none');
            checkIcon.classList.remove('d-none');
            copyFeedback.style.display = 'block';
            copyButton.style.borderColor = 'var(--color-success-fg)';

            setTimeout(() => {
                copyIcon.classList.remove('d-none');
                checkIcon.classList.add('d-none');
                copyFeedback.style.display = 'none';
                copyButton.style.borderColor = '';
            }, 2000);
        });
    });
});

</script>


</html>
